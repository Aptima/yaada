
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../getting-started/" rel="prev"/>
<link href="../tutorial/" rel="next"/>
<link href="../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.4.2, mkdocs-material-9.1.8" name="generator"/>
<title>Architecture and Concepts - Yet Another Analytic Dataflow Architecture</title>
<link href="../assets/stylesheets/main.ded33207.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../assets/_mkdocstrings.css" rel="stylesheet"/>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#concepts">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Yet Another Analytic Dataflow Architecture" class="md-header__button md-logo" data-md-component="logo" href=".." title="Yet Another Analytic Dataflow Architecture">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Yet Another Analytic Dataflow Architecture
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Architecture and Concepts
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Yet Another Analytic Dataflow Architecture" class="md-nav__button md-logo" data-md-component="logo" href=".." title="Yet Another Analytic Dataflow Architecture">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    Yet Another Analytic Dataflow Architecture
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
        Home
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../getting-started/">
        Getting Started
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Architecture and Concepts
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Architecture and Concepts
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#yaada-architecture">
    YAADA Architecture
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#elasticsearch-and-documents-and-data-ingest">
    Elasticsearch and Documents and Data Ingest
  </a>
<nav aria-label="Elasticsearch and Documents and Data Ingest" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#schemas">
    Schemas
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#analytics">
    Analytics
  </a>
<nav aria-label="Analytics" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#analytic-context">
    Analytic Context
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#analytic-models">
    Analytic Models
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pipeline-processors">
    Pipeline Processors
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tutorial/">
        Tutorial
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../openapi/">
        REST API
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#yaada-architecture">
    YAADA Architecture
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#elasticsearch-and-documents-and-data-ingest">
    Elasticsearch and Documents and Data Ingest
  </a>
<nav aria-label="Elasticsearch and Documents and Data Ingest" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#schemas">
    Schemas
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#analytics">
    Analytics
  </a>
<nav aria-label="Analytics" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#analytic-context">
    Analytic Context
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#analytic-models">
    Analytic Models
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pipeline-processors">
    Pipeline Processors
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="concepts">Concepts</h1>
<p>YAADA is a cloud-based data architecture and analytics platform designed to support the full analytics development spectrum, from prototyping to deployment-at-scale. YAADA’s primary focus is ingesting, storing, analyzing, and producing semi-structured document-oriented data.</p>
<h2 id="yaada-architecture">YAADA Architecture</h2>
<figure>
<p><img alt="YAADA Overview" src="../images/yaada.png" width="600"/>
</p>
<figcaption>YAADA Architecture</figcaption>
</figure>
<p>YAADA is a framework for handling and analyzing data. YAADA utilizes two data stores — Elasticsearch and S3 object storage — to provide services that allow for analysis and processing of data through Python-based analytics.</p>
<p>YAADA uses a containerized approach through Docker. A standard YAADA project will have the following Docker containers:</p>
<table>
<thead>
<tr>
<th>Container</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td>ingest</td>
<td>Handles asynchronous per-document processing at ingest time</td>
</tr>
<tr>
<td>sink</td>
<td>Handles sending data asynchronously to Elasticsearch</td>
</tr>
<tr>
<td>worker</td>
<td>Handles asynchronous execution of analytics</td>
</tr>
<tr>
<td>openapi</td>
<td>OpenAPI-based REST API</td>
</tr>
<tr>
<td>elasticsearch</td>
<td>3rd Party primary data store</td>
</tr>
<tr>
<td>kibana</td>
<td>3rd Party data exploration/dashboard app provided by Elastic</td>
</tr>
<tr>
<td>mosquitto</td>
<td>3rd Party MQTT messaging for communication between YAADA components</td>
</tr>
<tr>
<td>zenko</td>
<td>3rd Party S3 style object storage for models and file data</td>
</tr>
<tr>
<td>tika*</td>
<td>Optional 3rd Party service to parse text from a range of file types</td>
</tr>
<tr>
<td>jupyter*</td>
<td>Optional 3rd Party jupyter lab frontend for testing and running python code</td>
</tr>
</tbody>
</table>
<h2 id="elasticsearch-and-documents-and-data-ingest">Elasticsearch and Documents and Data Ingest</h2>
<p>Elasticsearch is the main database used to store and retrieve data in YAADA. Data in Elasticsearch is stored in documents, and can be queried using the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.10/query-dsl.html">Elasticsearch Query DSL</a>, a query language based on JSON.</p>
<p>Elasticsearch documents are the primary form of data that YAADA analytics operate over. Documents are semi-structured, JSON-like objects comprised of key/value pairs. They are represented as Python dictionaries in memory and transmitted across services as json-serialized objects.</p>
<p>All YAADA documents will at a mimimum have two required attributes:</p>
<table>
<thead>
<tr>
<th>Field Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>doc_type</code></td>
<td>String</td>
<td>The name of the type of document being represented. Used to determine the Elasticsearch index where the document will be stored.</td>
</tr>
<tr>
<td><code>id</code></td>
<td>String</td>
<td>The unique (within doc_type) id for the document. Used as Elasticsearch id. Autogenerated as a UUID if ommitted.</td>
</tr>
<tr>
<td><code>@timestamp</code></td>
<td>String</td>
<td>ISO 8601 formatted time that the document was ingested into Elasticsearch. Will be autogenerated.</td>
</tr>
</tbody>
</table>
<p>The format of a minimal YAADA document in python would look like this:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">"doc_type"</span><span class="p">:</span><span class="s2">"Foo"</span><span class="p">,</span>
<span class="w">  </span><span class="nt">"id"</span><span class="p">:</span><span class="s2">"1"</span><span class="p">,</span>
<span class="w">  </span><span class="nt">"foo"</span><span class="p">:</span><span class="s2">"bar"</span>
<span class="p">}</span>
</code></pre></div>
<p>With a default configuration, this document would be stored in the <code>yaada-{TENANT}-document-foo</code> index with an Elasticsearch unique id of “1”.</p>
<h3 id="schemas">Schemas</h3>
<p>YAADA supports defining document schemas as json or yaml files following the <a href="https://spec.openapis.org/oas/v3.0.0.html#schema-object">OpenAPI 3.0 json-schema variant</a>.</p>
<h2 id="analytics">Analytics</h2>
<p>A YAADA Analytic in it’s most general form is a parameterized function that takes in <code>0-n</code> documents and produces <code>0-m</code> documents.</p>
<p>Some common Analytics types are:</p>
<ul>
<li>acquire data – analytics that produce documents representing some external content such as news articles or data housed in an external API.</li>
<li>transform data – analytics that take in a set of documents and emit updated versions of those documents (think Map from Map/Reduce).</li>
<li>aggregate data – analytics that take in a set of documents, perform an analysis and produce a new document representing the aggregate analysis (think Reduce from Map/Reduce).</li>
</ul>
<p>Generally, most analytics will follow the data flow pattern shown here:</p>
<figure>
<p><img alt="Analytic Execution" src="../images/analytic-execution.png" width="600"/>
</p>
<figcaption>The typical flow of document data in an analytic</figcaption>
</figure>
<h3 id="analytic-context">Analytic Context</h3>
<p>YAADA provides a built-in <code>yaada.core.analytic.context.AnalyticContext</code> class that serves as the main API for interacting with or analyzing data. Most YAADA services will construct a single <code>context</code> object which will get used by any analytics or pipelines invoked to interact with the backend databases. A user can instantiated as a <code>context</code> object using the <code>yaada.core.analytic.context.make_analytic_context</code> method. Once instantiated, the context object provides a suite of methods for interacting with Elasticsearch, such as querying, fetching, and ingesting documents, as well as accessing YAADA capabilities like running analytics.</p>
<h3 id="analytic-models">Analytic Models</h3>
<p>Some analytics may be able to produce results in a stateless manner through simple inspection of the incoming documents, but often an analytic will have to use some outside resources to produce results, such as a trained language model. YAADA analytics may define an optional analytic model building step, where the analytic builds a named model from a set of documents and writes it out to a file or set of files to be stored in object storage, as illiustrated here.</p>
<figure>
<p><img alt="Train Analytic Model" src="../images/train-analytic-models.png" width="600"/>
</p>
<figcaption>Training and storing an analytic model based on documents</figcaption>
</figure>
<p>Models created in this way can then be loaded from object storage and used by analytics to produce results, whether that be the analytic that created it or another analytic. This is generally done by querying documents, using the model to analyze those documents, and then ingesting the results back into Elasticsearch, as shown in the following diagram. When an analytic uses a model, all produced results will be annotated with the name of the analytic model they were produced by.</p>
<figure>
<p><img alt="Apply Analytic Model" src="../images/apply-trained-models.png" width="600"/>
</p>
<figcaption>Using a pretrained analytic model to analyze documents and produce new results</figcaption>
</figure>
<h2 id="pipeline-processors">Pipeline Processors</h2>
<p>Pipelines allow you to run a series of transform functions on documents of a specific <code>doc_type</code> each time such a document is ingested. Each pipeline correspond to one <code>doc_type</code>. If a pieline is configured for a <code>doc_type</code>, upon ingest documents of that type are run through the series of processors configured for that pipeline. A processor, similarly to a single-document analytic, takes in a document and modifies or adds new data to it before sending it off to the next step in the pipeline. If and when all the steps of a pipeline are complete, the document is then sent to be ingested into Elasticsearch.</p>
<figure>
<p><img alt="Data Ingest" src="../images/data-ingest.png" width="600"/>
</p>
<figcaption>Ingested documents are run through a processing pipeline and then stored into Elasticsearch</figcaption>
</figure>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Aptima, Inc. 2023
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../assets/javascripts/bundle.51198bba.min.js"></script>
<script>document$.subscribe(() => {
            window.update_swagger_ui_iframe_height = function (id) {
                var iFrameID = document.getElementById(id);
                if (iFrameID) {
                    full_height = (iFrameID.contentWindow.document.body.scrollHeight + 80) + "px";
                    iFrameID.height = full_height;
                    iFrameID.style.height = full_height;
                }
            }
        
            let iframe_id_list = []
            var iframes = document.getElementsByClassName("swagger-ui-iframe");
            for (var i = 0; i < iframes.length; i++) { 
                iframe_id_list.push(iframes[i].getAttribute("id"))
            }
        
            let ticking = true;
            
            document.addEventListener('scroll', function(e) {
                if (!ticking) {
                    window.requestAnimationFrame(()=> {
                        let half_vh = window.innerHeight/2;
                        for(var i = 0; i < iframe_id_list.length; i++) {
                            let element = document.getElementById(iframe_id_list[i])
                            if(element==null){
                                return
                            }
                            let diff = element.getBoundingClientRect().top
                            if(element.contentWindow.update_top_val){
                                element.contentWindow.update_top_val(half_vh - diff)
                            }
                        }
                        ticking = false;
                    });
                    ticking = true;
                }
            });
        
            const dark_scheme_name = "slate"
            
            window.scheme = document.body.getAttribute("data-md-color-scheme")
            const options = {
                attributeFilter: ['data-md-color-scheme'],
            };
            function color_scheme_callback(mutations) {
                for (let mutation of mutations) {
                    if (mutation.attributeName === "data-md-color-scheme") {
                        scheme = document.body.getAttribute("data-md-color-scheme")
                        var iframe_list = document.getElementsByClassName("swagger-ui-iframe")
                        for(var i = 0; i < iframe_list.length; i++) {
                            var ele = iframe_list.item(i);
                            if (ele) {
                                if (scheme === dark_scheme_name) {
                                    ele.contentWindow.enable_dark_mode();
                                } else {
                                    ele.contentWindow.disable_dark_mode();
                                }
                            }
                        }
                    }
                }
            }
            observer = new MutationObserver(color_scheme_callback);
            observer.observe(document.body, options);
            })</script></body>
</html>